# IP 代理插件使用手册 (v2.3)

这是一个为 AstrBot 设计的 IP 代理插件，它能将远程 HTTP 代理 API 转换为本地代理服务，并实现自动 IP 切换和验证。

**此版本特性：**

*   **独立指令：** 所有功能均通过独立的、易于记忆的指令进行操作。
*   **指令别名：** 支持多种自然语言别名，使用更方便。
*   **在线配置：** 可通过指令动态修改核心配置。
*   **后台配置：** 也支持在 AstrBot 管理后台进行可视化配置。
*   **权限控制：** 所有操作指令均需要管理员权限。

## 安装方法

1.  **创建插件目录：** 在您的 AstrBot 的 `plugins` 目录下，创建一个新文件夹，例如 `ip_proxy_plugin`。
2.  **放置插件文件：** 将 `main.py` 和 `_conf_schema.json` 这两个文件都放入您刚刚创建的文件夹中。
3.  **重启 AstrBot：** 重启您的 AstrBot 服务以加载插件。

## 配置方法

您可以通过两种方式配置此插件，指令配置的优先级更高。

*   **后台配置（推荐用于首次配置）：**
    1.  启动 AstrBot 后，访问其 Web 管理界面。
    2.  在插件管理中找到 “IP Proxy Plugin”。
    3.  在表单中填写您的 API 地址 等信息并保存。

*   **指令配置（推荐用于动态修改）：**
    *   在聊天中向机器人发送指令来修改配置，详见下文指令列表。

## 指令列表

**注意：** 以下所有指令都需要管理员权限才能执行。

### 服务控制

*   **开启代理**
    *   主指令: `开启代理`
    *   别名: `启动代理`, `代理开启`
    *   作用: 启动本地代理服务。

*   **关闭代理**
    *   主指令: `关闭代理`
    *   别名: `代理关闭`, `取消代理`
    *   作用: 停止本地代理服务。

*   **查看状态**
    *   主指令: `代理状态`
    *   作用: 显示插件的详细运行状态，包括是否运行、监听地址、当前IP等。

### 配置修改

*   **修改代理API**
    *   指令格式: `修改代理API 新的API地址`
    *   示例: `修改代理API http://new.proxy.com/api?token=abc`

*   **修改监听地址**
    *   指令格式: `修改监听地址 IP地址`
    *   示例: `修改监听地址 0.0.0.0`
    *   注意: 修改后需要重启代理（先关闭再开启）才能生效。

*   **修改监听端口**
    *   指令格式: `修改监听端口 端口号`
    *   示例: `修改监听端口 1080`
    *   注意: 修改后需要重启代理（先关闭再开启）才能生效。

*   **修改测试URL**
    *   指令格式: `修改测试url 新的URL`
    *   示例: `修改测试url https://www.google.com`
    *   作用: 修改用于验证代理IP有效性的网址。
